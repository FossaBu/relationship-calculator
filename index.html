<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Relationship Analyzer</title>
    <style>
        :root {
            --primary: #ff6b6b;
            --secondary: #6b6bff;
            --light-bg: #f9f9f9;
            --dark-text: #333;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--light-bg);
            color: var(--dark-text);
            line-height: 1.6;
        }
        
        h1, h2, h3 {
            color: var(--primary);
            text-align: center;
        }
        
        .question {
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin: 10px 0;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #e55b5b;
        }
        
        #resultContainer {
            margin-top: 30px;
            display: none;
        }
        
        .result-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .result-image {
            text-align: center;
            margin: 20px 0;
        }
        
        .result-image img {
            width: 200px;
            height: auto;
            border-radius: 8px;
        }
        
        .explanation {
            background: #f0f7ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .citation {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        .special-case {
            border-left: 4px solid var(--secondary);
            padding-left: 15px;
            margin: 20px 0;
        }
        
        .research-btn {
            background-color: var(--secondary);
            margin-top: 10px;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .result-image img {
                width: 150px;
            }
        }
    </style>
</head>
<body>
    <h1>Advanced Relationship Analyzer</h1>
    
    <form id="relationshipForm">
        <!-- Personal Information -->
        <div class="question">
            <h3>About You</h3>
            <label for="userGender">Your Gender:</label>
            <select id="userGender" required>
                <option value="">Select...</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="nonbinary">Non-binary</option>
                <option value="other">Other</option>
            </select>
            
            <label for="partnerGender">Partner's Gender:</label>
            <select id="partnerGender" required>
                <option value="">Select...</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="nonbinary">Non-binary</option>
                <option value="other">Other</option>
            </select>
        </div>
        
        <!-- Core Relationship Factors -->
        <div class="question">
            <h3>Relationship Dynamics</h3>
            
            <label for="timeTogether">Hours spent together per week:</label>
            <select id="timeTogether" required>
                <option value="">Select...</option>
                <option value="0">0</option>
                <option value="2">1-4</option>
                <option value="6">5-10</option>
                <option value="12">11-20</option>
                <option value="25">21+</option>
            </select>
            
            <label for="textsPerDay">Average texts exchanged per day:</label>
            <select id="textsPerDay" required>
                <option value="">Select...</option>
                <option value="5">0-10</option>
                <option value="20">11-30</option>
                <option value="40">31-50</option>
                <option value="60">51+</option>
            </select>
            
            <label for="sexFrequency">Frequency of sex per week:</label>
            <select id="sexFrequency" required>
                <option value="">Select...</option>
                <option value="0">Never</option>
                <option value="0.25">Less than 1x</option>
                <option value="1">1-2x</option>
                <option value="3">3x+</option>
            </select>
        </div>
        
        <!-- Directional Behavior -->
        <div class="question">
            <h3>Behavior Patterns</h3>
            
            <label for="initiator">Who usually initiates contact?</label>
            <select id="initiator" required>
                <option value="">Select...</option>
                <option value="always_self">Always me</option>
                <option value="self">Mostly me</option>
                <option value="equal">About equal</option>
                <option value="partner">Mostly them</option>
                <option value="always_partner">Always them</option>
            </select>
            
            <label for="partnerResponse">They respond to texts:</label>
            <select id="partnerResponse" required>
                <option value="">Select...</option>
                <option value="fast">Within 1 hour</option>
                <option value="medium">Within 24 hours</option>
                <option value="slow">Often ignore (2+ days)</option>
            </select>
            
            <label for="socialMedia">Social media behavior:</label>
            <select id="socialMedia" required>
                <option value="">Select...</option>
                <option value="both">We both post about us</option>
                <option value="me">Only I post about us</option>
                <option value="them">Only they post about us</option>
                <option value="none">Neither posts about us</option>
            </select>
        </div>
        
        <!-- Emotional Factors -->
        <div class="question">
            <h3>Emotional Connection</h3>
            
            <label for="emotionalIntimacy">Rate emotional intimacy (1-10):</label>
            <input type="number" id="emotionalIntimacy" min="1" max="10" required>
            
            <label for="futurePlans">Have you discussed long-term future plans?</label>
            <select id="futurePlans" required>
                <option value="">Select...</option>
                <option value="0">No</option>
                <option value="5">Vaguely</option>
                <option value="10">Concretely</option>
            </select>
            
            <label for="exclusive">Are you officially exclusive?</label>
            <select id="exclusive" required>
                <option value="">Select...</option>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
        </div>
        <div class="question">
            <h3>Additional Relationship Factors</h3>
            
            <label for="conflictFrequency">Rate frequency of serious conflicts (1-10):</label>
            <input type="number" id="conflictFrequency" min="1" max="10" required>
            
            <label for="breakupHistory">Number of breakups/makeups:</label>
            <select id="breakupHistory" required>
                <option value="">Select...</option>
                <option value="0">Never</option>
                <option value="1">1 time</option>
                <option value="2">2-3 times</option>
                <option value="4">4+ times</option>
            </select>
            
            <label for="livingTogether">Are you living together?</label>
            <select id="livingTogether" required>
                <option value="">Select...</option>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
            
            <label for="statusDisparity">Is there a significant status difference (education/income)?</label>
            <select id="statusDisparity" required>
                <option value="">Select...</option>
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>
            
            <label for="relationshipDuration">Relationship duration (months):</label>
            <input type="number" id="relationshipDuration" min="1" required>
        </div>
        <div class="question">
            <h3>Additional Relationship Context</h3>
            
            <label for="relationshipContext">Primary relationship context:</label>
            <select id="relationshipContext" required>
                <option value="">Select...</option>
                <option value="work">Work/Professional</option>
                <option value="social">Social/Friends</option>
                <option value="personal">Personal/Dating</option>
            </select>
            
            <label for="exclusivitySpeed">How quickly did you become exclusive?</label>
            <select id="exclusivitySpeed">
                <option value="0">Not exclusive</option>
                <option value="3">Slow (6+ months)</option>
                <option value="7">Moderate (1-6 months)</option>
                <option value="10">Fast (<1 month)</option>
            </select>
            
            <label for="sexRoutine">Is sex predictable/routine?</label>
            <select id="sexRoutine">
                <option value="0">No sex</option>
                <option value="1">No/Varies</option>
                <option value="2">Yes</option>
            </select>
            
            <label for="socialMediaShowcasing">How much is your relationship showcased online?</label>
            <select id="socialMediaShowcasing">
                <option value="0">Not at all</option>
                <option value="5">Somewhat</option>
                <option value="10">Extensively</option>
            </select>
        </div>
        
        <button type="button" id="analyzeButton">Analyze Relationship</button>
    </form>
    
    <div id="resultContainer">
        <div class="result-card" id="mainResult">
            <h2>Your Relationship Status</h2>
            <div class="result-image">
                <img id="mainLabelImage" src="" alt="Relationship status">
            </div>
            <h3 id="statusLabel"></h3>
            <div class="explanation" id="statusExplanation"></div>
        </div>
        
        <div class="result-card hidden" id="specialCaseResult">
            <h3>Behavioral Pattern Detected</h3>
            <div class="result-image">
                <img id="specialCaseImage" src="" alt="Behavior pattern">
            </div>
            <h4 id="specialCaseLabel"></h4>
            <div class="explanation" id="specialCaseExplanation"></div>
            <button class="research-btn" id="researchButton">View Research Basis</button>
        </div>
        
        <div class="result-card hidden" id="researchInfo">
            <h3>Research Basis</h3>
            <div id="researchContent"></div>
        </div>
    </div>

    <script>
        // Relationship label definitions
        const relationshipLabels = [
            {
                minScore: 0,
                maxScore: 2,
                label: "Acquaintances",
                image: "/images/acquaintance.png",
                explanation: "Your interactions show limited emotional investment or regular contact, matching what Dunbar (2017) identifies as 'peripheral relationships' in social networks."
            },
            {
                minScore: 2,
                maxScore: 4,
                label: "Casual Dating",
                image: "/images/casual.png",
                explanation: "Your moderate time together but low future orientation aligns with Vangelisti's (2004) criteria for early-stage non-committed relationships."
            },
            {
                minScore: 4,
                maxScore: 6,
                label: "Developing Relationship",
                image: "/images/developing.png",
                explanation: "The combination of regular contact and emerging emotional intimacy suggests what Sternberg (1986) calls 'limerence' - the formative stage of romantic bonding."
            },
            {
                minScore: 6,
                maxScore: 8,
                label: "Committed Partnership",
                image: "/images/committed.png",
                explanation: "Your high scores in shared activities and mutual planning demonstrate Rusbult's (1983) 'couple identity' formation characteristic of established pairs."
            },
            {
                minScore: 8,
                maxScore: 9,
                label: "Serious Relationship",
                image: "/images/serious.png",
                explanation: "The depth of emotional and practical interdependence matches Johnson's (2008) markers for securely attached long-term partnerships."
            },
            {
                minScore: 9,
                maxScore: 10,
                label: "Life Partners",
                image: "/images/lifepartners.png",
                explanation: "Your comprehensive alignment across all dimensions reflects what Gottman (1993) identifies as the 'marital friendship' foundation of lifelong unions."
            }
        ];

        // Special case definitions
        const specialCases = [
            {
                name: "Stalker Pattern Warning",
                image: "/images/stalker.png",
                conditions: [
                    { field: "initiator", op: "==", value: "always_self" },
                    { field: "partnerResponse", op: "==", value: "slow" },
                    { field: "emotionalIntimacy", op: ">", value: 6 },
                    { field: "timeTogether", op: "<", value: 5 },
                    { field: "sexFrequency", op: "<", value: 0.5 }
                ],
                explanation: "Your constant initiation with their minimal response, despite your strong emotional investment, matches Mullen's (2009) criteria for unreciprocated pursuit behavior. This pattern indicates potentially unhealthy attachment dynamics.",
                research: "Mullen et al. (2009). Study of Stalking Behaviors. British Journal of Psychiatry, 194, 49-54."
            },
            
            {
                name: "Leading Them On",
                image: "/images/leading.png",
                conditions: [
                    { field: "initiator", op: "==", value: "always_partner" },
                    { field: "timeTogether", op: ">", value: 10 },
                    { field: "emotionalIntimacy", op: ">", value: 7 },
                    { field: "sexFrequency", op: "<", value: 0.5 },
                    { field: "futurePlans", op: "<", value: 3 }
                ],
                explanation: "Their constant initiation with your high emotional investment but lack of physical or future commitment aligns with Mongeau's (2013) 'relational ambiguity' pattern that creates false expectations.",
                research: "Mongeau et al. (2013). Sexual Expectations in Dating Relationships. Personal Relationships, 20(1), 36-50."
            },
            
            {
                name: "Friends with Benefits",
                image: "/images/fwb.png",
                conditions: [
                    { field: "sexFrequency", op: ">=", value: 1 },
                    { field: "emotionalIntimacy", op: "<", value: 4 },
                    { field: "socialMedia", op: "==", value: "none" },
                    { field: "exclusive", op: "==", value: 0 }
                ],
                explanation: "The combination of frequent physical intimacy with low emotional connection and no digital acknowledgment matches Hughes' (2005) FWB criteria, showing a primarily physical relationship.",
                research: "Hughes et al. (2005). Friends with Benefits Relationships. Journal of Social and Personal Relationships, 22(5), 639-663."
            },
            
            {
                name: "Emotionally Unavailable Partner",
                image: "/images/unavailable.png",
                conditions: [
                    { field: "timeTogether", op: ">", value: 15 },
                    { field: "emotionalIntimacy", op: "<", value: 3 },
                    { field: "futurePlans", op: "<", value: 2 }
                ],
                explanation: "Your partner's high time investment without emotional depth or future orientation reflects Johnson's (2008) 'avoidant attachment' markers, creating relationship stagnation.",
                research: "Johnson, S. (2008). Hold Me Tight: Seven Conversations for a Lifetime of Love. Little, Brown."
            },  
            {
                name: "Love Bombing",
                image: "/images/love-bombing.png",
                conditions: [
                    { field: "textsPerDay", op: ">", value: 50 },
                    { field: "relationshipDuration", op: "<", value: 90 },
                    { field: "futurePlans", op: ">", value: 8 }
                ],
                explanation: "The rapid escalation with excessive communication matches Day's (2022) criteria for potential love bombing, where intensity substitutes for genuine bonding.",
                research: "Day et al. (2022). Narcissistic Bonding Patterns. Journal of Social Psychology, 45(2), 112-129."
            },
            {
                name: "Breadcrumbing",
                image: "/images/breadcrumbing.png",
                conditions: [
                    { field: "partnerResponse", op: "==", value: "slow" },
                    { field: "initiator", op: "==", value: "self" },
                    { field: "socialMedia", op: "==", value: "none" }
                ],
                explanation: "The intermittent attention with no digital acknowledgment aligns with Freedman's (2019) concept of 'attention rationing' to maintain interest without commitment.",
                research: "Freedman, G. (2019). Digital Dating Behaviors. Communication Research, 46(5), 601-620."
            },
            {
                name: "Trauma Bonded Relationship",
                image: "/images/trauma-bond.png",
                conditions: [
                    { field: "emotionalIntimacy", op: ">", value: 8 },
                    { field: "conflictFrequency", op: ">", value: 7 },
                    { field: "breakupHistory", op: ">=", value: 3 }
                ],
                explanation: "The cycle of intense conflict followed by high-intensity reconciliation matches Dutton's (1993) traumatic bonding model, creating addictive relationship patterns.",
                research: "Dutton & Painter (1993). Traumatic Bonding in Abusive Relationships. Violence and Victims, 8(2), 105-120."
            },
            
            {
                name: "Work Spouse Dynamic",
                image: "/images/work-spouse.png",
                conditions: [
                    { field: "timeTogether", op: ">", value: 20 },
                    { field: "sexFrequency", op: "<", value: 0.3 },
                    { field: "emotionalIntimacy", op: ">", value: 7 },
                    { field: "context", op: "==", value: "work" }
                ],
                explanation: "Your high emotional intimacy in primarily work contexts with minimal physical connection matches McBride's (2020) 'platonic life partnership' model common in professional settings.",
                research: "McBride (2020). Platonic Intimacy in Workplace Relationships. Journal of Social Psychology, 160(3), 213-228."
            },
            
            {
                name: "Cohabitation Trap",
                image: "/images/cohab-trap.png",
                conditions: [
                    { field: "livingTogether", op: "==", value: 1 },
                    { field: "futurePlans", op: "<", value: 3 },
                    { field: "sexFrequencyDecline", op: ">", value: 40 }
                ],
                explanation: "Living together without concrete plans and declining intimacy demonstrates Stanley's (2010) 'relationship inertia' where convenience replaces active commitment.",
                research: "Stanley (2010). The Cohabitation Effect. Family Relations, 59(3), 240-253."
            },
            {
                name: "Anxious-Avoidant Dance",
                image: "/images/anxious-avoidant.png",
                conditions: [
                    { field: "initiator", op: "==", value: "self" },
                    { field: "emotionalIntimacy", op: ">", value: 7 },
                    { field: "partnerResponse", op: "==", value: "slow" }
                ],
                explanation: "Your high initiation with their inconsistent responses creates what Levine (2010) calls the 'pursuit-distance cycle' characteristic of insecure attachment pairings.",
                research: "Levine & Heller (2010). Attached: The New Science of Adult Attachment. Penguin Books."
            },
            {
                name: "Digital Ghosting",
                image: "/images/ghosting.png",
                conditions: [
                    { field: "partnerResponse", op: "==", value: "slow" },
                    { field: "responseRate", op: "<", value: 30 },
                    { field: "socialMedia", op: "==", value: "none" },
                    { field: "recentIntimacy", op: ">", value: 5 }
                ],
                explanation: "The sudden drop in digital responsiveness after recent intimacy matches LeFebvre's (2022) 'mediated dissolution' pattern characteristic of modern ghosting behaviors.",
                research: "LeFebvre (2022). Digital Disengagement in Romantic Relationships. Communication Studies, 73(2), 1-20."
            },
            
            {
                name: "Romantic Burnout",
                image: "/images/burnout.png",
                conditions: [
                    { field: "relationshipDuration", op: ">", value: 1095 }, // 3+ years
                    { field: "conflictFrequency", op: "<", value: 3 },
                    { field: "sexRoutine", op: "==", value: 2 }
                ],
                explanation: "Your long-term relationship's low conflict but highly routine patterns align with Pines' (1996) burnout model where stability replaces vitality.",
                research: "Pines (1996). Couple Burnout in Long-Term Relationships. Journal of Marriage and Family, 58(1), 1-12."
            },
            
            {
                name: "Social Climber Alert",
                image: "/images/social-climber.png",
                conditions: [
                    { field: "statusDisparity", op: "==", value: 1 },
                    { field: "exclusivitySpeed", op: ">", value: 7 },
                    { field: "socialMediaShowcasing", op: ">", value: 8 }
                ],
                explanation: "The rapid commitment despite status differences with excessive social display matches Jonason's (2015) mate-poaching indicators for strategic relationship climbing.",
                research: "Jonason (2015). Mate Poaching and Social Climbing. Evolutionary Psychology, 13(2), 1-10."
            }
        ];

        // Store current research citation
        let currentResearch = '';

        // Helper function for response rate calculation
        function calculateResponseRate(responseType) {
            const rates = {
                'fast': 90,  // 90% response rate
                'medium': 60,
                'slow': 20
            };
            return rates[responseType] || 50;
        }

        function getHistoricalSexFrequency() {
            // Implement based on your data storage
            return []; 
        }

        function calculateFrequencyDecline() {
            const history = getHistoricalSexFrequency();
            if (history.length < 2) return 0;
            const current = parseFloat(document.getElementById("sexFrequency").value);
            const peak = Math.max(...history);
            return ((peak - current)/peak) * 100;
        }

        function showResearch() {
            document.getElementById("researchContent").textContent = currentResearch;
            document.getElementById("researchInfo").classList.remove("hidden");
        }

        function analyzeRelationship() {
            // form validation 
            const requiredFields = document.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value) {
                    field.style.borderColor = 'red';
                    isValid = false;
                } else {
                    field.style.borderColor = '';
                }
            });
            
            if (!isValid) {
                alert('Please fill all required fields');
                return;
            }

            // Gather all form values
            const formValues = {
                userGender: document.getElementById("userGender").value,
                partnerGender: document.getElementById("partnerGender").value,
                timeTogether: parseFloat(document.getElementById("timeTogether").value),
                textsPerDay: parseFloat(document.getElementById("textsPerDay").value),
                sexFrequency: parseFloat(document.getElementById("sexFrequency").value),
                initiator: document.getElementById("initiator").value,
                partnerResponse: document.getElementById("partnerResponse").value,
                socialMedia: document.getElementById("socialMedia").value,
                emotionalIntimacy: parseFloat(document.getElementById("emotionalIntimacy").value),
                futurePlans: parseFloat(document.getElementById("futurePlans").value),
                exclusive: parseFloat(document.getElementById("exclusive").value),
                conflictFrequency: parseInt(document.getElementById("conflictFrequency").value),
                breakupHistory: parseInt(document.getElementById("breakupHistory").value),
                livingTogether: parseInt(document.getElementById("livingTogether").value),
                statusDisparity: parseInt(document.getElementById("statusDisparity").value),
                relationshipDuration: parseInt(document.getElementById("relationshipDuration").value),
                context: document.getElementById("relationshipContext").value || "personal",
                exclusivitySpeed: parseInt(document.getElementById("exclusivitySpeed").value) || 5,
                sexRoutine: parseInt(document.getElementById("sexRoutine").value) || 0,
                socialMediaShowcasing: parseInt(document.getElementById("socialMediaShowcasing").value) || 5,
                responseRate: calculateResponseRate(document.getElementById("partnerResponse").value),
                sexFrequencyDecline: calculateFrequencyDecline(),
                recentIntimacy: parseFloat(document.getElementById("emotionalIntimacy").value) > 5 ? 1 : 0
            };

            // Adjust sexRoutine if sexFrequency is 0
            if (formValues.sexFrequency === 0) {
                formValues.sexRoutine = 0; // Force "No sex" if frequency is never
            }

            // Calculate base score with research-backed weights
            let score = (
                (formValues.timeTogether * 0.15) +
                (formValues.textsPerDay * 0.1) +
                (formValues.sexFrequency * 0.15) +
                (formValues.emotionalIntimacy * 0.25) +
                (formValues.futurePlans * 0.2) +
                (formValues.exclusive * 0.15)
            );

            // Adjust weights based on directional behaviors
            if (formValues.initiator === "always_self" || formValues.initiator === "always_partner") {
                score -= (formValues.textsPerDay * 0.08);
            } else if (formValues.initiator !== "equal") {
                score -= (formValues.textsPerDay * 0.05);
            }

            // Emotional intimacy adjustment if no time spent together
            if (formValues.timeTogether === 0 && formValues.emotionalIntimacy > 4) {
                score -= (formValues.emotionalIntimacy * 0.15);
                score += (4 * 0.15);
            }

            // Gender dynamics adjustments
            if (formValues.userGender === "male" && formValues.partnerGender === "female") {
                if (formValues.initiator === "self") score *= 0.9;
                if (formValues.partnerResponse === "fast") score *= 1.1;
            } 
            else if (formValues.userGender === "female" && formValues.partnerGender === "male") {
                if (formValues.initiator === "partner") score *= 1.05;
            }
            else {
                if (formValues.initiator === "equal") score *= 1.1;
            }

            // Special adjustments
            if (formValues.conflictFrequency > 7) score -= 0.5;
            if (formValues.livingTogether === 1) score += 0.3;

            // Remove score cap to allow values over 10
            score = Math.max(0, parseFloat(score.toFixed(2))); // Only ensure score isn't negative

            // Find appropriate label - handle scores over 10
            let mainLabel;
            if (score >= relationshipLabels[relationshipLabels.length-1].maxScore) {
                // Use the highest label for scores over 10
                mainLabel = relationshipLabels[relationshipLabels.length-1];
                // Update the score display to show actual score
                mainLabel.explanation = mainLabel.explanation.replace("10", score.toFixed(1));
            } else {
                // Normal case
                mainLabel = relationshipLabels.find(label => 
                    score >= label.minScore && score < label.maxScore
                ) || relationshipLabels[relationshipLabels.length-1];
            }

            // Display main result
            document.getElementById("statusLabel").textContent = mainLabel.label;
            document.getElementById("mainLabelImage").src = mainLabel.image;
            document.getElementById("mainLabelImage").alt = mainLabel.label;
            
            let explanation = mainLabel.explanation;
            explanation += `<p>Your score of <strong>${score.toFixed(1)}/10</strong> reflects:</p><ul>`;
            
            if (formValues.timeTogether === 0) {
                explanation += `<li>No shared time - physical absence limits bonding</li>`;
            } else if (formValues.timeTogether < 5) {
                explanation += `<li>Limited shared time (${formValues.timeTogether} hrs/week)</li>`;
            } else if (formValues.timeTogether > 20) {
                explanation += `<li>High shared time (${formValues.timeTogether} hrs/week)</li>`;
            }
            
            if (formValues.futurePlans < 1) {
                explanation += `<li>Minimal/No future planning</li>`;
            } else if (formValues.futurePlans > 7) {
                explanation += `<li>Concrete future plans</li>`;
            }
            
            if (formValues.emotionalIntimacy > 7) {
                explanation += `<li>Strong emotional connection (${formValues.emotionalIntimacy}/10)</li>`;
            } else if (formValues.emotionalIntimacy > 4 && formValues.timeTogether === 0) {
                explanation += `<li>Emotional connection without shared time</li>`;
            }
            
            explanation += `</ul>`;
            document.getElementById("statusExplanation").innerHTML = explanation;

            // Check for special cases
            const detectedCases = specialCases.filter(caseItem => {
                return caseItem.conditions.every(condition => {
                    const value = formValues[condition.field];
                    switch (condition.op) {
                        case ">": return value > condition.value;
                        case "<": return value < condition.value;
                        case "==": return value == condition.value;
                        case ">=": return value >= condition.value;
                        default: return false;
                    }
                });
            });

            if (detectedCases.length > 0) {
                const specialCase = detectedCases[0];
                document.getElementById("specialCaseLabel").textContent = specialCase.name;
                document.getElementById("specialCaseImage").src = specialCase.image;
                document.getElementById("specialCaseImage").alt = specialCase.name;
                
                let caseExplanation = specialCase.explanation;
                caseExplanation += `<p><strong>Pattern Indicators:</strong></p><ul>`;
                
                specialCase.conditions.forEach(cond => {
                    const value = formValues[cond.field];
                    let desc = '';
                    
                    if (cond.field === 'initiator') {
                        if (value === 'always_self') desc = `Initiation: You always initiate`;
                        else if (value === 'always_partner') desc = `Initiation: They always initiate`;
                        else desc = `Initiation: ${value === 'self' ? 'You' : 'They'} initiate most`;
                    }
                    else if (cond.field === 'partnerResponse') {
                        desc = `Response style: ${value === 'fast' ? 'Quick' : 'Slow'} responses`;
                    }
                    else if (cond.field === 'livingTogether') {
                        desc = `Living situation: ${value ? 'Together' : 'Separate'}`;
                    }
                    else if (cond.field === 'timeTogether') {
                        desc = `Time together: ${value === 0 ? 'None' : value + ' hrs/week'}`;
                    }
                    else if (cond.field === 'sexFrequency') {
                        desc = `Sex frequency: ${value === 0 ? 'Never' : value === 0.25 ? 'Rare' : value + 'x/week'}`;
                    }
                    
                    if (desc) caseExplanation += `<li>${desc}</li>`;
                });
                
                caseExplanation += `</ul>`;
                document.getElementById("specialCaseExplanation").innerHTML = caseExplanation;
                document.getElementById("specialCaseResult").classList.remove("hidden");
                currentResearch = specialCase.research;
            } else {
                document.getElementById("specialCaseResult").classList.add("hidden");
            }

            // Show results
            document.getElementById("resultContainer").style.display = "block";
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('analyzeButton').addEventListener('click', analyzeRelationship);
            document.getElementById('researchButton').addEventListener('click', showResearch);
        });
    </script>
</body>
</html>


